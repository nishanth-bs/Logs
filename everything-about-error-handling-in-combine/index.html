<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Everything about Error Handling in Combine | Decoded With Nishanth</title><meta name=keywords content="Swift,Combine"><meta name=description content="Everything about Error Handling in Combine
In the previous article, while discussing the 5 essential caveats to remember to master Combine, we touched upon error handling briefly. In this article, we will dive deep into error handling in Combine, covering everything there is about built in error handling in Combine.
This article is part of a series where I dive deep into iOS concepts, exploring the smallest details often overlooked by typical articles. I aim to blend definitions with practical insights for a clear and actionable understanding. Whether you&rsquo;re a seasoned developer or eager to learn, this series will provide the insights and skills needed to master these powerful frameworks. Let‚Äôs get started."><meta name=author content="Nishanth"><link rel=canonical href=https://nishanth-bs.github.io/everything-about-error-handling-in-combine/><link crossorigin=anonymous href=https://nishanth-bs.github.io/assets/css/stylesheet.8fe10233a706bc87f2e08b3cf97b8bd4c0a80f10675a143675d59212121037c0.css integrity="sha256-j+ECM6cGvIfy4Is8+XuL1MCoDxBnWhQ2ddWSEhIQN8A=" rel="preload stylesheet" as=style><link rel=icon href=https://nishanth-bs.github.io/images/nishanth0.5x.png><link rel=icon type=image/png sizes=16x16 href=https://nishanth-bs.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://nishanth-bs.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://nishanth-bs.github.io/apple-touch-icon.png><link rel=mask-icon href=https://nishanth-bs.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://nishanth-bs.github.io/everything-about-error-handling-in-combine/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=https://nishanth-bs.github.io/css/custom.css><meta property="og:url" content="https://nishanth-bs.github.io/everything-about-error-handling-in-combine/"><meta property="og:site_name" content="Decoded With Nishanth"><meta property="og:title" content="Everything about Error Handling in Combine"><meta property="og:description" content="Everything about Error Handling in Combine In the previous article, while discussing the 5 essential caveats to remember to master Combine, we touched upon error handling briefly. In this article, we will dive deep into error handling in Combine, covering everything there is about built in error handling in Combine.
This article is part of a series where I dive deep into iOS concepts, exploring the smallest details often overlooked by typical articles. I aim to blend definitions with practical insights for a clear and actionable understanding. Whether you‚Äôre a seasoned developer or eager to learn, this series will provide the insights and skills needed to master these powerful frameworks. Let‚Äôs get started."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-07-22T03:56:00+05:30"><meta property="article:modified_time" content="2024-07-22T03:56:00+05:30"><meta property="article:tag" content="Swift"><meta property="article:tag" content="Combine"><meta name=twitter:card content="summary"><meta name=twitter:title content="Everything about Error Handling in Combine"><meta name=twitter:description content="Everything about Error Handling in Combine
In the previous article, while discussing the 5 essential caveats to remember to master Combine, we touched upon error handling briefly. In this article, we will dive deep into error handling in Combine, covering everything there is about built in error handling in Combine.
This article is part of a series where I dive deep into iOS concepts, exploring the smallest details often overlooked by typical articles. I aim to blend definitions with practical insights for a clear and actionable understanding. Whether you&rsquo;re a seasoned developer or eager to learn, this series will provide the insights and skills needed to master these powerful frameworks. Let‚Äôs get started."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://nishanth-bs.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Everything about Error Handling in Combine","item":"https://nishanth-bs.github.io/everything-about-error-handling-in-combine/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Everything about Error Handling in Combine","name":"Everything about Error Handling in Combine","description":"Everything about Error Handling in Combine In the previous article, while discussing the 5 essential caveats to remember to master Combine, we touched upon error handling briefly. In this article, we will dive deep into error handling in Combine, covering everything there is about built in error handling in Combine.\nThis article is part of a series where I dive deep into iOS concepts, exploring the smallest details often overlooked by typical articles. I aim to blend definitions with practical insights for a clear and actionable understanding. Whether you\u0026rsquo;re a seasoned developer or eager to learn, this series will provide the insights and skills needed to master these powerful frameworks. Let‚Äôs get started.\n","keywords":["Swift","Combine"],"articleBody":"Everything about Error Handling in Combine In the previous article, while discussing the 5 essential caveats to remember to master Combine, we touched upon error handling briefly. In this article, we will dive deep into error handling in Combine, covering everything there is about built in error handling in Combine.\nThis article is part of a series where I dive deep into iOS concepts, exploring the smallest details often overlooked by typical articles. I aim to blend definitions with practical insights for a clear and actionable understanding. Whether you‚Äôre a seasoned developer or eager to learn, this series will provide the insights and skills needed to master these powerful frameworks. Let‚Äôs get started.\nGetting Started In Combine, the Publisher protocol is the core building block. It has two associated types: Output and Failure. In this article, we‚Äôll focus only on the Failure aspect of it.\nThe associatedtype Failure represents the type of error that a given publisher can emit. The Failure type must conform to the Error protocol. This allows Combine to handle errors in a type-safe manner.\nIf a publisher does not emit errors, you should use Never as the Failure type.\nCore Concepts of Failure What happens when a Publisher emits Failure?\nLet‚Äôs define our own CustomError as follows, which we will use throughout:\nenum CustomError: Error { case invalidArgument case unknown } Let‚Äôs now create a publisher that emits Failure. Here, we‚Äôve initialised Fail operator with our CustomError.\nFail creates a publisher that immediately terminates with the specified failure.\nvar cancellable = Fail(error: CustomError.unknown) .map { value in print(\"inside Map\") // \u003c----- Skipped return value } .sink { completion in print(completion) } receiveValue: { value in print(value) } As expected, the map operator following the Fail operator is not executed and the chain terminates with the below output\nOutput: failure(__lldb_expr_12.CustomError.invalidArgument) So what happens when a publisher emits Failure? When an upstream publisher throws an error, the default behaviour given the error handling operators are not used is as following:\nWhen a publisher emits a failure, it will cancel itself and stop publishing immediately! The publisher sends a cancel event to all the upstream publishers, cancelling all publishers upstream. (This gets evident when you add handleEvents operator in your chain.) The failure message will be passed downstream, and operators that handle errors will process this failure, propagating it all the way to the final subscriber. (Downstream publishers that expect success gets skipped.) This will result in the chain completing with a Subscribers.Completion.failure enum.\nFailure is not an option... except in Combine üìù As the upstream publishers are cancelled, note that the publishers will no longer emit values. So, even if you repackage your Failure into Output, this will only impact your downstream subscribers, and how the chain completes.\nüìù Always remember that the operators that expect a success from upstream, skip execution whenever when there is an upstream Failure.\nHandling Errors Instead of looking at various operators in isolation, let‚Äôs break down error handling into different use cases you might encounter. For each use case, we‚Äôll explore various equivalent approaches that you can take.\nWe can broadly break down the general use cases into the follow categories:\nTerminate Execution on Failure Transform Failure to different Failure and terminate chain Transform Failure to Output and terminate chain Transform Failure to Ouptut and continue chain Retry Failure We will use the code snippet below to test the above use cases. Here is a link to the Gist.\nNote: Downstream publishers that expect a Failure type will execute regardless of upstream errors. When I use the term ‚ÄúTerminate‚Äù in the context below, I am referring specifically to operators that expect an Output.\nUse case #1: Terminate Execution on Error You want the execution to terminate immediately on error, skipping the downstream subscribers and completing with a Subscribers.Completion.failure enum.\nDesired Output based on the requirement:\n`Received subscription: Ages [21, -1, 27] Received request: unlimited Received publisher output: 21 Inside tryMap for: 21 Inside map after tryMap for: 21 Sink Value: 21 Received publisher output: -1 Inside tryMap for: -1 Throwing for -1 as age cannot be negative Received cancel. Sink Completion: failure(__lldb_expr_173.CustomError.invalidArgument)` Notice how the publisher is terminated as soon as Failure is thrown.\nApproach: This is the default behaviour. The upstream Failure event passes through unchanged to the final subscriber without modification, and no additional operators are needed.\nOn running the previous Gist code example without modifications, we get the desired output which is the default behaviour\nAs you can see, cancel is called immediately after the Failure occurs. This causes the chain to terminate instantly with a Failure completion.\nUse case #2: Terminate, and change the Failure type Your requirements are the same as in Use Case #1 (terminate execution immediately on error), but you also want to change the Failure type. For example, you might map it to your own CustomError type.\nIn our Gist example, we want to replace the current CustomError with UserError, while preserving the default behaviour. Specifically:\nIf the CustomError was unknown earlier, the corresponding UserError should be tryAgain.\nIf the CustomError was invalidArgument earlier, the corresponding UserError should be invalidInput.\nThe code should complete with a Failure, and the output should reflect that the Failure type is now UserError.\nDesired Output based on the requirement: `Received subscription: Ages [21, -1, 27] Received request: unlimited Received publisher output: 21 Inside tryMap for: 21 Inside map after tryMap for: 21 Sink Value: 21 Received publisher output: -1 Inside tryMap for: -1 Throwing for -1 as age cannot be negative Received cancel. Sink Completion: failure(__lldb_expr_177.UserError.invalidInput)` Notice the type of Failure thrown in sink. It‚Äôs no longer CustomError\nApproach: The code snippets below can be added after .tryMap in our Gist example. They are all equivalent and will generate the desired output:\n1. mapError(_:) operator: Converts the upstream error to a new error type. It accepts the upstream failure as a parameter and returns a new error for the publisher to terminate with.\nExample: Now add the below mapError operator after tryMap in the previous example. (We‚Äôll dive deep into why there is an optional caste for CustomError in the next section of this article.)\n.mapError { error in let error = error as? CustomError ?? .unknown switch error { case .unknown: return UserError.tryAgain case .invalidArgument: return UserError.invalidInput } } When you make the above changes and check the output, you‚Äôll see that a UserError, a new type of error, is thrown as expected.\n2. Throwing within tryCatch(_:) operator: You can also achieve the current use case requirement by throwing a different error type within the tryCatch block.\n.tryCatch { error -\u003e AnyPublisher in let error = error as? CustomError ?? .unknown switch error { case .unknown: throw UserError.tryAgain case .invalidArgument: throw UserError.invalidInput } } The output generated will be the same as the desired output.\nUse case #3: Continue Execution Downstream and Complete with .finished You want to continue the execution of the downstream subscribers and have the chain complete with Subscribers.Completion.finished, even if an upstream error occurs.\nKeep calm and carry on Desired Output based on the requirement:\nReceived subscription: Ages [21, -1, 27] Received request: unlimited Received publisher output: 21 Inside tryMap for: 21 Inside map after tryMap for: 21 Sink Value: 21 Received publisher output: -1 Inside tryMap for: -1 Throwing for -1 as age cannot be negative Received cancel. Inside map after tryMap for: 0 Sink Value: 0 Sink Completion: finished Notice how, despite repackaging the error into a success, the cancellation is still triggered. Additionally, as a side effect of the Output, the final map block also gets executed.\nApproach: The code snippets below can be added after .tryMap in our Gist example. They are all equivalent and will generate the desired output:\n1. replaceError(with:) operator: Replaces the upstream error with an Output value, allowing the downstream chain to continue and complete with .finished.\n.replaceError(with: 0) 2. catch(_:) operator: Handles the error and provides a new publisher that emits a successful value, allowing the downstream chain to continue.\n.catch { _ in Just(0) } 3. Return withintryCatch(_:) Operator: Handles the error and returns a new publisher to continue execution with a successful value.\n.tryCatch { _ in Just(0) } Use Case #4: Continue Execution Downstream and Prevent Chain Termination On Failure, you want to continue as if nothing happened. You neither want to cancel upstream publishers nor let the chain cancel or terminate. (this is a hacky approach; the chain still dies but within context).\nThe show must go on... Desired Output based on the requirement:\nReceived subscription: Ages [21, -1, 27] Received request: unlimited Received publisher output: 21 Inside tryMap for: 21 Inside map after tryMap for: 21 Sink Value: 21 Received publisher output: -1 Inside tryMap for: -1 Throwing for -1 as age cannot be negative Inside map after tryMap for: 0 Sink Value: 0 Received publisher output: 27 Inside tryMap for: 27 Inside map after tryMap for: 27 Sink Value: 27 Received completion: finished Sink Completion: finished Notice how the despite the error, the publisher is not cancelled and continue execution and it finishes normally.\nApproach: Nested flatMap operator: Use a nested flatMap to handle errors by emitting a new publisher that continues execution. Since flatMap is non-throwing, you can nest the entire throwing publisher within this block and manage errors inside the flatMap operator.\n.flatMap { value in Just(value) .tryMap { value in print(\"Inside tryMap for: \", value) guard value != 0 else { print(\"Throwing as condition failed.\") throw CustomError.invalidArgument } return value } .catch { error in Just(2) } } How does this work?\n.catch() terminates the upstream publisher and replaces it with the publisher provided as its argument. This results in a .finished completion when using Just() as the replacement publisher.\nInside .flatMap, you replace the publisher with a new one, so the termination of the original publisher by .catch() does not affect the replacement publisher. Thus, the original upstream publisher remains unaffected.\nUse Case #5: Retry on Failure On Failure, you want to retry few more times before passing on the Failure to the downstream publisher.\nWhen you fail: Try, try, and try again Desired Output based on the requirement:\nReceived subscription: Ages [21, -1, 27] Received request: unlimited Received publisher output: 21 Inside tryMap for: 21 Inside map after tryMap for: 21 Sink Value: 21 Received publisher output: -1 Inside tryMap for: -1 Throwing for -1 as age cannot be negative Received cancel. Received subscription: Ages [21, -1, 27] Received request: unlimited Received publisher output: 21 Inside tryMap for: 21 Inside map after tryMap for: 21 Sink Value: 21 Received publisher output: -1 Inside tryMap for: -1 Throwing for -1 as age cannot be negative Received cancel. Sink Completion: failure(__lldb_expr_201.CustomError.invalidArgument) Notice how the subscription connection is established twice before the error is finally thrown in the Sink completion.\nApproach: retry(_:) operator: Use retry(_:) to try a connecting to an upstream publisher after a failed attempt.\nTo achieve the desired output, we first need to extract the throwing block into a separate publisher variable.\nWe then apply the retry operator to this publisher. If the publisher emits a Failure, retry will reattempt the connection with the upstream publisher for the specified number of retries.\npublisher.retry(1) Additional Key Concepts in Error Handling 1. setFailureType(to:) Say, you are using Combine‚Äôs merge publishers such as - merge(with:), zip(_:) etc. (We won‚Äôt dive deep into the implementation of these, maybe some other article)\nThe first publisher emits whereas the second publisher emits . Can you tell what‚Äôs wrong in the below code?\nlet pub1 = [0, 1, 2, 3, 4, 5].publisher let pub2 = CurrentValueSubject(0) let cancellable = pub1 .combineLatest(pub2) .sink( receiveCompletion: { print (\"completed: \\($0)\") }, receiveValue: { print (\"value: \\($0)\")} ) When combining publishers, operators expect the publishers to emit the same failure type. If different error types are emitted, the code will fail. The compiler is smart enough to catch this error.\nBut, why does this happen?\nOperators enforce this check to maintain type safety, ensuring a single type of error is emitted from a publisher. At any point in the chain, the type of Output and Failure should be determinable. Otherwise, an error will be thrown.\nHow to solve this?\nCombine provides a built-in operator for such scenarios: setFailureType(to:).\nsetFailureType(to:) changes the failure type declared by the upstream publisher. This is used for setting the error type of a publisher that cannot fail.\nIn the above example, adding this operator after pub1 will resolve the error.\n.setFailureType(to: CustomError.self) 2. try* operators You must be familiar with the try* variant of operators.\nIn our example for mapError above for Use case #2, you can notice that we had to optionally caste the error into our CustomError type. The compiler otherwise complained that it could not identify the type\nBut, why did this happen?\nThese operators can emit either an Output or a Failure\nSwift doesn‚Äôt support typed throws yet. This means when you use try* operators, your error type will always be erased to the most common ancestor: Error.\nThereby need the optional type caste into our desired Error type.\nAs we‚Äôve already looked into above, mapError handles this use case perfectly.\n3. assertNoFailure operator: When you‚Äôre sure that the given programming path cannot throw an Error, you can use assertNoFailure(_:file:line:).\nIt raises a fatal error when its upstream publisher fails, and otherwise republishes all received input.\nAs per Apple documentation: Use assertNoFailure() for internal integrity checks during testing. However, similar to fatalError(_:) in Swift, assertNoFailure() will trigger a fatal exception in both development and shipping versions of your code if a failure is encountered.\nStrictly avoid this in production code as this is unsafe and makes assumptions. Use safer techniques discussed earlier.\nAnd, that‚Äôs a wrap.\nThese are the built-in error handling operators supported by Combine. You can mix and match these operators to suit your specific use cases.\nIn our next article, we will explore the nuances to keep in mind while creating a custom Publisher, including a custom publisher that will retry a given publisher up to a specific times and based on if whether the given condition is met. If you‚Äôre feeling adventurous, try this exercise and hit me up!\nStay tuned for more in-depth articles. Subscribe for free to receive new posts and support my work.\nSubscribeIf you found this helpful, click the üíö and give it a clap below so others can discover it on Substack. For any questions or suggestions, feel free to leave a comment or reach out to me on Twitter or LinkedIn.\nEnjoyed the Article? Buy Me a Coffee!\nLet‚Äôs push the boundaries of iOS development together!\nReferences:\nhttps://stackoverflow.com/questions/58675235/combine-how-to-replace-catch-an-error-without-completing-the-original-publisher\nhttps://stackoverflow.com/questions/69371982/swift-combine-framework-setfailuretype-error-operator\nhttps://developer.apple.com/documentation/combine/empty/setfailuretype(to:)\nhttps://stackoverflow.com/questions/58227096/set-a-given-publishers-failure-type-to-never-in-combine\nhttps://stackoverflow.com/questions/58675235/combine-how-to-replace-catch-an-error-without-completing-the-original-publisher\n","wordCount":"2453","inLanguage":"en","datePublished":"2024-07-22T03:56:00+05:30","dateModified":"2024-07-22T03:56:00+05:30","author":{"@type":"Person","name":"Nishanth"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://nishanth-bs.github.io/everything-about-error-handling-in-combine/"},"publisher":{"@type":"Organization","name":"Decoded With Nishanth","logo":{"@type":"ImageObject","url":"https://nishanth-bs.github.io/images/nishanth0.5x.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://nishanth-bs.github.io/ accesskey=h title="Decoded With Nishanth (Alt + H)">Decoded With Nishanth</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://nishanth-bs.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://nishanth-bs.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://nishanth-bs.github.io/about/ title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://nishanth-bs.github.io/>Home</a>&nbsp;¬ª&nbsp;<a href=https://nishanth-bs.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Everything about Error Handling in Combine</h1><div class=post-meta><span title='2024-07-22 03:56:00 +0530 IST'>July 22, 2024</span>&nbsp;¬∑&nbsp;12 min&nbsp;¬∑&nbsp;Nishanth<div class=user-count-wrapper><span class=user-count>üìä ~<span class=user-count-number>...</span> unique reads</span>
<script>const endpoint="https://nishanth-blog-views-count-keeper-git-main-nishanth-bss-projects.vercel.app/api/view";fetch(endpoint,{method:"POST",headers:{"Content-Type":"application/json"}}).then(e=>e.json()).then(()=>{const e=window.location.pathname.replace(/\/$/,"");fetch(`https://decoded-with-nishanth-default-rtdb.asia-southeast1.firebasedatabase.app/views${e}.json`).then(e=>e.json()).then(e=>{const t=document.querySelector(".user-count");if(t){const n=e||1,s=n===1?"unique read":"unique reads";t.innerHTML=`üìä ~<span class="user-count-number">${n}</span> ${s}`}})})</script></div></div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#everything-about-error-handling-in-combine aria-label="Everything about Error Handling in Combine">Everything about Error Handling in Combine</a><ul><li><a href=#getting-started aria-label="Getting Started">Getting Started</a></li><li><a href=#core-concepts-of-failure aria-label="Core Concepts of Failure">Core Concepts of Failure</a><ul><ul><li><a href=#so-what-happens-when-a-publisher-emits aria-label="So what happens when a publisher emits Failure?">So what happens when a publisher emits Failure?</a></li></ul></ul></li><li><a href=#handling-errors aria-label="Handling Errors">Handling Errors</a></li><li><a href=#use-case-1-terminate-execution-on-error aria-label="Use case #1: Terminate Execution on Error">Use case #1: Terminate Execution on Error</a><ul><li><a href=#approach aria-label=Approach:>Approach:</a></li></ul></li><li><a href=#use-case-2-terminate-and-change-the-failure-type aria-label="Use case #2: Terminate, and change the Failure type">Use case #2: Terminate, and change the Failure type</a><ul><ul><ul><li><a href=#desired-output-based-on-the-requirement aria-label="Desired Output based on the requirement:">Desired Output based on the requirement:</a></li></ul></ul><li><a href=#approach-1 aria-label=Approach:>Approach:</a><ul><li><a href=#1-maperror_-operator aria-label="1. mapError(_:) operator:">1. mapError(_:) operator:</a></li><li><a href=#2-throwing-within-trycatch_-operator aria-label="2. Throwing within tryCatch(_:) operator:">2. Throwing within tryCatch(_:) operator:</a></li></ul></li></ul></li><li><a href=#use-case-3-continue-execution-downstream-and-complete-with-finished aria-label="Use case #3: Continue Execution Downstream and Complete with .finished">Use case #3: Continue Execution Downstream and Complete with .finished</a><ul><li><a href=#approach-2 aria-label=Approach:>Approach:</a><ul><li><a href=#1-replaceerrorwith-operator aria-label="1. replaceError(with:) operator:">1. replaceError(with:) operator:</a></li><li><a href=#2-catch_-operator aria-label="2. catch(_:) operator:">2. catch(_:) operator:</a></li><li><a href=#3-return-withintrycatch_-operator aria-label="3. Return withintryCatch(_:) Operator:">3. Return withintryCatch(_:) Operator:</a></li></ul></li></ul></li><li><a href=#use-case-4-continue-execution-downstream-and-prevent-chain-termination aria-label="Use Case #4: Continue Execution Downstream and Prevent Chain Termination">Use Case #4: Continue Execution Downstream and Prevent Chain Termination</a><ul><li><a href=#approach-3 aria-label=Approach:>Approach:</a><ul><li><a href=#nested-flatmap-operator aria-label="Nested flatMap operator:">Nested flatMap operator:</a></li></ul></li></ul></li><li><a href=#use-case-5-retry-on-failure aria-label="Use Case #5: Retry on Failure">Use Case #5: Retry on Failure</a><ul><li><a href=#approach-4 aria-label=Approach:>Approach:</a><ul><li><a href=#retry_-operator aria-label="retry(_:) operator:">retry(_:) operator:</a></li></ul></li></ul></li><li><a href=#additional-key-concepts-in-error-handling aria-label="Additional Key Concepts in Error Handling">Additional Key Concepts in Error Handling</a><ul><ul><li><a href=#1-setfailuretypeto aria-label="1. setFailureType(to:)">1. setFailureType(to:)</a></li><li><a href=#2-try-operators aria-label="2. try* operators">2. try* operators</a></li><li><a href=#3-assertnofailure-operator aria-label="3. assertNoFailure operator:">3. assertNoFailure operator:</a></li></ul></li></ul></ul></li></ul></div></details></div><div class=post-content><h1 id=everything-about-error-handling-in-combine>Everything about Error Handling in Combine<a hidden class=anchor aria-hidden=true href=#everything-about-error-handling-in-combine>#</a></h1><p>In the previous article, while discussing the 5 essential caveats to remember to master Combine, we touched upon error handling briefly. In this article, we will dive deep into error handling in Combine, covering everything there is about built in error handling in Combine.</p><p>This article is part of a series where I dive deep into iOS concepts, exploring the smallest details often overlooked by typical articles. I aim to blend definitions with practical insights for a clear and actionable understanding. Whether you&rsquo;re a seasoned developer or eager to learn, this series will provide the insights and skills needed to master these powerful frameworks. Let‚Äôs get started.</p><h2 id=getting-started>Getting Started<a hidden class=anchor aria-hidden=true href=#getting-started>#</a></h2><p>In Combine, the <code>Publisher</code> protocol is the core building block. It has two associated types: <code>Output</code> and <code>Failure</code>. In this article, we‚Äôll focus only on the <code>Failure</code> aspect of it.</p><figure style="margin:1rem 0;text-align:center"><img src=https://nishanth-bs.github.io/post-images/combine-error-handling/2.png alt style="display:block;margin:0 auto;max-width:100%;border-radius:8px"><figcaption style=font-size:.9rem;color:gray;margin-top:.5rem></figcaption></figure><p>The associatedtype <code>Failure</code> represents the type of error that a given publisher can emit. The <code>Failure</code> type must conform to the <code>Error</code> protocol. This allows Combine to handle errors in a type-safe manner.</p><p>If a publisher does not emit errors, you should use <code>Never</code> as the <code>Failure</code> type.</p><hr><h2 id=core-concepts-of-failure>Core Concepts of Failure<a hidden class=anchor aria-hidden=true href=#core-concepts-of-failure>#</a></h2><p><strong>What happens when a Publisher emits <code>Failure?</code></strong></p><p>Let‚Äôs define our own <code>CustomError</code> as follows, which we will use throughout:</p><pre tabindex=0><code>enum CustomError: Error {
    case invalidArgument
    case unknown
}
</code></pre><p>Let‚Äôs now create a publisher that emits <code>Failure</code>. Here, we‚Äôve initialised <code>Fail</code> operator with our <code>CustomError</code>.</p><p><a href=https://developer.apple.com/documentation/combine/fail>Fail</a> creates a publisher that immediately terminates with the specified failure.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>var</span> cancellable = Fail&lt;Int, CustomError&gt;(error: CustomError.unknown)
</span></span><span style=display:flex><span>    .map { value <span style=color:#66d9ef>in</span>
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;inside Map&#34;</span>)  <span style=color:#75715e>// &lt;----- Skipped</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> value
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    .sink { completion <span style=color:#66d9ef>in</span>
</span></span><span style=display:flex><span>        print(completion)
</span></span><span style=display:flex><span>    } receiveValue: { value <span style=color:#66d9ef>in</span>
</span></span><span style=display:flex><span>        print(value)
</span></span><span style=display:flex><span>    }
</span></span></code></pre></div><p>As expected, the <code>map</code> operator following the <code>Fail</code> operator is <strong>not</strong> executed and the chain terminates with the below output</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>Output: 
</span></span><span style=display:flex><span>failure(__lldb_expr_12.CustomError.invalidArgument)
</span></span></code></pre></div><h4 id=so-what-happens-when-a-publisher-emits><strong>So what happens when a publisher emits <code>Failure</code>?</strong><a hidden class=anchor aria-hidden=true href=#so-what-happens-when-a-publisher-emits>#</a></h4><p>When an upstream publisher throws an error, the default behaviour given the error handling operators are not used is as following:</p><ol><li>When a publisher emits a failure, it will cancel itself and stop publishing immediately!</li><li>The publisher <strong>sends a cancel event to all the upstream publishers</strong>, cancelling all publishers upstream. (This gets evident when you add <a href=https://developer.apple.com/documentation/combine/publisher/handleevents(receivesubscription:receiveoutput:receivecompletion:receivecancel:receiverequest:)>handleEvents</a> operator in your chain.)</li><li>The failure message will be passed downstream, and operators that handle errors will process this failure, propagating it all the way to the final subscriber. (Downstream publishers that expect success gets skipped.)</li></ol><p>This will result in the chain completing with a <a href=https://developer.apple.com/documentation/combine/subscribers/completion/failure(_:)>Subscribers.Completion.failure</a> enum.</p><figure style="margin:1rem 0;text-align:center"><img src=https://nishanth-bs.github.io/post-images/combine-error-handling/1.gif alt style="display:block;margin:0 auto;max-width:100%;border-radius:8px"><figcaption style=font-size:.9rem;color:gray;margin-top:.5rem>Failure is not an option... except in Combine</figcaption></figure><p>üìù <strong>As the upstream publishers are cancelled, note that the publishers will no longer emit values. So,</strong> <strong>even if you repackage your Failure into Output, this will only impact your downstream subscribers, and how the chain completes.</strong></p><p>üìù <strong>Always remember that the operators that expect a success from upstream, skip execution whenever when there is an upstream Failure.</strong></p><hr><h2 id=handling-errors>Handling Errors<a hidden class=anchor aria-hidden=true href=#handling-errors>#</a></h2><p>Instead of looking at various operators in isolation, let‚Äôs break down error handling into different use cases you might encounter. For each use case, we&rsquo;ll explore various equivalent approaches that you can take.</p><p>We can broadly break down the general use cases into the follow categories:</p><ol><li>Terminate Execution on Failure</li><li>Transform Failure to different Failure and terminate chain</li><li>Transform Failure to Output and terminate chain</li><li>Transform Failure to Ouptut and continue chain</li><li>Retry Failure</li></ol><p>We will use the code snippet below to test the above use cases. <a href=https://gist.github.com/nishanth-bs/ce82d917cade69077b6655dac5552e3b>Here is a link to the Gist</a>.</p><p><script src=https://gist.github.com/nishanth-bs/ce82d917cade69077b6655dac5552e3b.js></script><br><strong>Note:</strong> Downstream publishers that expect a <code>Failure</code> type will execute regardless of upstream errors. When I use the term &ldquo;Terminate&rdquo; in the context below, I am referring specifically to operators that expect an <code>Output</code>.</p><h2 id=use-case-1-terminate-execution-on-error><strong>Use case #1</strong>: <strong>Terminate Execution on Error</strong><a hidden class=anchor aria-hidden=true href=#use-case-1-terminate-execution-on-error>#</a></h2><p>You want the execution to terminate immediately on error, skipping the downstream subscribers and completing with a <a href=https://developer.apple.com/documentation/combine/subscribers/completion/failure(_:)>Subscribers.Completion.failure</a> enum.</p><figure style="margin:1rem 0;text-align:center"><img src=https://nishanth-bs.github.io/post-images/combine-error-handling/3.gif alt style="display:block;margin:0 auto;max-width:100%;border-radius:8px"><figcaption style=font-size:.9rem;color:gray;margin-top:.5rem></figcaption></figure><p><strong>Desired Output based on the requirement:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>`Received subscription: Ages [<span style=color:#ae81ff>21</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>27</span>]
</span></span><span style=display:flex><span>Received request: unlimited
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Received publisher output: <span style=color:#ae81ff>21</span>
</span></span><span style=display:flex><span>Inside tryMap <span style=color:#66d9ef>for</span>: <span style=color:#ae81ff>21</span>
</span></span><span style=display:flex><span>Inside map after tryMap <span style=color:#66d9ef>for</span>: <span style=color:#ae81ff>21</span>
</span></span><span style=display:flex><span>Sink Value: <span style=color:#ae81ff>21</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Received publisher output: <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Inside tryMap <span style=color:#66d9ef>for</span>: <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Throwing <span style=color:#66d9ef>for</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span> <span style=color:#66d9ef>as</span> age cannot be negative
</span></span><span style=display:flex><span>Received cancel.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Sink Completion: failure(__lldb_expr_173.CustomError.invalidArgument)`
</span></span></code></pre></div><p>Notice how the publisher is terminated as soon as Failure is thrown.</p><h3 id=approach><strong>Approach:</strong><a hidden class=anchor aria-hidden=true href=#approach>#</a></h3><p>This is the default behaviour. The upstream <code>Failure</code> event passes through unchanged to the final subscriber without modification, and no additional operators are needed.</p><p>On running the previous Gist code example without modifications, we get the desired output which is the default behaviour</p><p>As you can see, <code>cancel</code> is called immediately after the Failure occurs. This causes the chain to terminate instantly with a <code>Failure</code> completion.</p><h2 id=use-case-2-terminate-and-change-the-failure-type><strong>Use case #2</strong>: Terminate, and change the Failure type<a hidden class=anchor aria-hidden=true href=#use-case-2-terminate-and-change-the-failure-type>#</a></h2><p>Your requirements are the same as in Use Case #1 (terminate execution immediately on error), but you also want to change the <code>Failure</code> type. For example, you might map it to your own <code>CustomError</code> type.</p><figure style="margin:1rem 0;text-align:center"><img src=https://nishanth-bs.github.io/post-images/combine-error-handling/4.png alt style="display:block;margin:0 auto;max-width:100%;border-radius:8px"><figcaption style=font-size:.9rem;color:gray;margin-top:.5rem></figcaption></figure><p>In our Gist example, we want to replace the current <code>CustomError</code> with <code>UserError</code>, while preserving the default behaviour. Specifically:</p><ul><li><p>If the <code>CustomError</code> was <code>unknown</code> earlier, the corresponding <code>UserError</code> should be <code>tryAgain</code>.</p></li><li><p>If the <code>CustomError</code> was <code>invalidArgument</code> earlier, the corresponding <code>UserError</code> should be <code>invalidInput</code>.</p></li></ul><p>The code should complete with a <code>Failure</code>, and the output should reflect that the <code>Failure</code> type is now <code>UserError</code>.</p><h5 id=desired-output-based-on-the-requirement><strong>Desired Output based on the requirement:</strong><a hidden class=anchor aria-hidden=true href=#desired-output-based-on-the-requirement>#</a></h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>`Received subscription: Ages [<span style=color:#ae81ff>21</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>27</span>]
</span></span><span style=display:flex><span>Received request: unlimited
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Received publisher output: <span style=color:#ae81ff>21</span>
</span></span><span style=display:flex><span>Inside tryMap <span style=color:#66d9ef>for</span>: <span style=color:#ae81ff>21</span>
</span></span><span style=display:flex><span>Inside map after tryMap <span style=color:#66d9ef>for</span>: <span style=color:#ae81ff>21</span>
</span></span><span style=display:flex><span>Sink Value: <span style=color:#ae81ff>21</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Received publisher output: <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Inside tryMap <span style=color:#66d9ef>for</span>: <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Throwing <span style=color:#66d9ef>for</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span> <span style=color:#66d9ef>as</span> age cannot be negative
</span></span><span style=display:flex><span>Received cancel.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Sink Completion: failure(__lldb_expr_177.UserError.invalidInput)`
</span></span></code></pre></div><p>Notice the type of <code>Failure</code> thrown in sink. It‚Äôs no longer <code>CustomError</code></p><h3 id=approach-1><strong>Approach:</strong><a hidden class=anchor aria-hidden=true href=#approach-1>#</a></h3><p>The code snippets below can be added after <code>.tryMap</code> in our Gist example. They are all equivalent and will generate the desired output:</p><h4 id=1-maperror_-operator><code>1. mapError(_:)</code> <strong>operator</strong>:<a hidden class=anchor aria-hidden=true href=#1-maperror_-operator>#</a></h4><p>Converts the upstream error to a new error type. It accepts the upstream failure as a parameter and returns a new error for the publisher to terminate with.</p><p>Example: Now add the below mapError operator after tryMap in the previous example. (We‚Äôll dive deep into why there is an optional caste for <code>CustomError</code> in the next section of this article.)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>.mapError { error <span style=color:#66d9ef>in</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> error = error <span style=color:#66d9ef>as</span>? CustomError ?? .unknown
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>switch</span> error {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>case</span> .unknown:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> UserError.tryAgain
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>case</span> .invalidArgument:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> UserError.invalidInput
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>When you make the above changes and check the output, you‚Äôll see that a <code>UserError</code>, a new type of error, is thrown as expected.</p><h4 id=2-throwing-within-trycatch_-operator><strong>2. Throwing within</strong> <code>tryCatch(_:)</code> <strong>operator</strong>:<a hidden class=anchor aria-hidden=true href=#2-throwing-within-trycatch_-operator>#</a></h4><p>You can also achieve the current use case requirement by throwing a different error type within the <code>tryCatch</code> block.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>.tryCatch { error -&gt; AnyPublisher&lt;Int, UserError&gt; <span style=color:#66d9ef>in</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> error = error <span style=color:#66d9ef>as</span>? CustomError ?? .unknown
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>switch</span> error {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>case</span> .unknown:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>throw</span> UserError.tryAgain
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>case</span> .invalidArgument:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>throw</span> UserError.invalidInput
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>The output generated will be the same as the desired output.</p><h2 id=use-case-3-continue-execution-downstream-and-complete-with-finished><strong>Use case #3</strong>: Continue Execution Downstream and Complete with <code>.finished</code><a hidden class=anchor aria-hidden=true href=#use-case-3-continue-execution-downstream-and-complete-with-finished>#</a></h2><p>You want to continue the execution of the downstream subscribers and have the chain complete with <a href=https://developer.apple.com/documentation/combine/subscribers/completion/finished>Subscribers.Completion.finished</a>, even if an upstream error occurs.</p><figure style="margin:1rem 0;text-align:center"><img src=https://nishanth-bs.github.io/post-images/combine-error-handling/5.gif alt style="display:block;margin:0 auto;max-width:100%;border-radius:8px"><figcaption style=font-size:.9rem;color:gray;margin-top:.5rem>Keep calm and carry on</figcaption></figure><p><strong>Desired Output based on the requirement:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>Received subscription: Ages  [<span style=color:#ae81ff>21</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>27</span>]
</span></span><span style=display:flex><span>Received request:  unlimited
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Received publisher output:  <span style=color:#ae81ff>21</span>
</span></span><span style=display:flex><span>Inside tryMap <span style=color:#66d9ef>for</span>:  <span style=color:#ae81ff>21</span>
</span></span><span style=display:flex><span>Inside map after tryMap <span style=color:#66d9ef>for</span>:  <span style=color:#ae81ff>21</span>
</span></span><span style=display:flex><span>Sink Value:  <span style=color:#ae81ff>21</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Received publisher output:  <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Inside tryMap <span style=color:#66d9ef>for</span>:  <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Throwing <span style=color:#66d9ef>for</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span> <span style=color:#66d9ef>as</span> age cannot be negative
</span></span><span style=display:flex><span>Received cancel.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Inside map after tryMap <span style=color:#66d9ef>for</span>:  <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>Sink Value:  <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Sink Completion:  finished
</span></span></code></pre></div><p>Notice how, despite repackaging the error into a success, the cancellation is still triggered. Additionally, as a side effect of the <code>Output</code>, the final <code>map</code> block also gets executed.</p><h3 id=approach-2><strong>Approach</strong>:<a hidden class=anchor aria-hidden=true href=#approach-2>#</a></h3><p>The code snippets below can be added after <code>.tryMap</code> in our Gist example. They are all equivalent and will generate the desired output:</p><h4 id=1-replaceerrorwith-operator><code>1. replaceError(with:)</code> operator:<a hidden class=anchor aria-hidden=true href=#1-replaceerrorwith-operator>#</a></h4><p>Replaces the upstream error with an <code>Output</code> value, allowing the downstream chain to continue and complete with <code>.finished</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>.replaceError(with: <span style=color:#ae81ff>0</span>)
</span></span></code></pre></div><h4 id=2-catch_-operator><code>2. catch(_:)</code> operator:<a hidden class=anchor aria-hidden=true href=#2-catch_-operator>#</a></h4><p>Handles the error and provides a new publisher that emits a successful value, allowing the downstream chain to continue.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>.<span style=color:#66d9ef>catch</span> { <span style=color:#66d9ef>_</span> <span style=color:#66d9ef>in</span>
</span></span><span style=display:flex><span>    Just(<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h4 id=3-return-withintrycatch_-operator>3. Return within<code>tryCatch(_:)</code> Operator:<a hidden class=anchor aria-hidden=true href=#3-return-withintrycatch_-operator>#</a></h4><p>Handles the error and returns a new publisher to continue execution with a successful value.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>.tryCatch { <span style=color:#66d9ef>_</span> <span style=color:#66d9ef>in</span>
</span></span><span style=display:flex><span>    Just(<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=use-case-4-continue-execution-downstream-and-prevent-chain-termination><strong>Use Case #4</strong>: Continue Execution Downstream and Prevent Chain Termination<a hidden class=anchor aria-hidden=true href=#use-case-4-continue-execution-downstream-and-prevent-chain-termination>#</a></h2><p>On Failure, you want to continue as if nothing happened. You neither want to cancel upstream publishers nor let the chain cancel or terminate. (this is a <strong>hacky approach</strong>; the chain still dies but within context).</p><figure style="margin:1rem 0;text-align:center"><img src=https://nishanth-bs.github.io/post-images/combine-error-handling/6.gif alt style="display:block;margin:0 auto;max-width:100%;border-radius:8px"><figcaption style=font-size:.9rem;color:gray;margin-top:.5rem>The show must go on...</figcaption></figure><p><strong>Desired Output based on the requirement:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>Received subscription: Ages  [<span style=color:#ae81ff>21</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>27</span>]
</span></span><span style=display:flex><span>Received request:  unlimited
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Received publisher output:  <span style=color:#ae81ff>21</span>
</span></span><span style=display:flex><span>Inside tryMap <span style=color:#66d9ef>for</span>:  <span style=color:#ae81ff>21</span>
</span></span><span style=display:flex><span>Inside map after tryMap <span style=color:#66d9ef>for</span>:  <span style=color:#ae81ff>21</span>
</span></span><span style=display:flex><span>Sink Value:  <span style=color:#ae81ff>21</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Received publisher output:  <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Inside tryMap <span style=color:#66d9ef>for</span>:  <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Throwing <span style=color:#66d9ef>for</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span> <span style=color:#66d9ef>as</span> age cannot be negative
</span></span><span style=display:flex><span>Inside map after tryMap <span style=color:#66d9ef>for</span>:  <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>Sink Value:  <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Received publisher output:  <span style=color:#ae81ff>27</span>
</span></span><span style=display:flex><span>Inside tryMap <span style=color:#66d9ef>for</span>:  <span style=color:#ae81ff>27</span>
</span></span><span style=display:flex><span>Inside map after tryMap <span style=color:#66d9ef>for</span>:  <span style=color:#ae81ff>27</span>
</span></span><span style=display:flex><span>Sink Value:  <span style=color:#ae81ff>27</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Received completion:  finished
</span></span><span style=display:flex><span>Sink Completion:  finished
</span></span></code></pre></div><p>Notice how the despite the error, the publisher is not cancelled and continue execution and it finishes normally.</p><h3 id=approach-3><strong>Approach:</strong><a hidden class=anchor aria-hidden=true href=#approach-3>#</a></h3><h4 id=nested-flatmap-operator>Nested <code>flatMap</code> operator:<a hidden class=anchor aria-hidden=true href=#nested-flatmap-operator>#</a></h4><p>Use a nested <code>flatMap</code> to handle errors by emitting a new publisher that continues execution. Since <code>flatMap</code> is non-throwing, you can nest the entire throwing publisher within this block and manage errors inside the <code>flatMap</code> operator.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>.flatMap { value <span style=color:#66d9ef>in</span>
</span></span><span style=display:flex><span>    Just(value)
</span></span><span style=display:flex><span>        .tryMap { value <span style=color:#66d9ef>in</span>
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>&#34;Inside tryMap for: &#34;</span>, value)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>guard</span> value <span style=color:#f92672>!=</span> <span style=color:#ae81ff>0</span> <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>                print(<span style=color:#e6db74>&#34;Throwing as condition failed.&#34;</span>)
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>throw</span> CustomError.invalidArgument
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> value
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        .<span style=color:#66d9ef>catch</span> { error <span style=color:#66d9ef>in</span>
</span></span><span style=display:flex><span>            Just(<span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>How does this work?</strong></p><ul><li><p><code>.catch()</code> terminates the upstream publisher and replaces it with the publisher provided as its argument. This results in a <code>.finished</code> completion when using <code>Just()</code> as the replacement publisher.</p></li><li><p>Inside <code>.flatMap</code>, you replace the publisher with a new one, so the termination of the original publisher by <code>.catch()</code> does not affect the replacement publisher. Thus, the original upstream publisher remains unaffected.</p></li></ul><h2 id=use-case-5-retry-on-failure><strong>Use Case #5</strong>: Retry on Failure<a hidden class=anchor aria-hidden=true href=#use-case-5-retry-on-failure>#</a></h2><p>On Failure, you want to retry few more times before passing on the Failure to the downstream publisher.</p><figure style="margin:1rem 0;text-align:center"><img src=https://nishanth-bs.github.io/post-images/combine-error-handling/7.gif alt style="display:block;margin:0 auto;max-width:100%;border-radius:8px"><figcaption style=font-size:.9rem;color:gray;margin-top:.5rem>When you fail: Try, try, and try again</figcaption></figure><p><strong>Desired Output based on the requirement:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>Received subscription: Ages  [<span style=color:#ae81ff>21</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>27</span>]
</span></span><span style=display:flex><span>Received request:  unlimited
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Received publisher output:  <span style=color:#ae81ff>21</span>
</span></span><span style=display:flex><span>Inside tryMap <span style=color:#66d9ef>for</span>:  <span style=color:#ae81ff>21</span>
</span></span><span style=display:flex><span>Inside map after tryMap <span style=color:#66d9ef>for</span>:  <span style=color:#ae81ff>21</span>
</span></span><span style=display:flex><span>Sink Value:  <span style=color:#ae81ff>21</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Received publisher output:  <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Inside tryMap <span style=color:#66d9ef>for</span>:  <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Throwing <span style=color:#66d9ef>for</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span> <span style=color:#66d9ef>as</span> age cannot be negative
</span></span><span style=display:flex><span>Received cancel.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Received subscription: Ages  [<span style=color:#ae81ff>21</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>27</span>]
</span></span><span style=display:flex><span>Received request:  unlimited
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Received publisher output:  <span style=color:#ae81ff>21</span>
</span></span><span style=display:flex><span>Inside tryMap <span style=color:#66d9ef>for</span>:  <span style=color:#ae81ff>21</span>
</span></span><span style=display:flex><span>Inside map after tryMap <span style=color:#66d9ef>for</span>:  <span style=color:#ae81ff>21</span>
</span></span><span style=display:flex><span>Sink Value:  <span style=color:#ae81ff>21</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Received publisher output:  <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Inside tryMap <span style=color:#66d9ef>for</span>:  <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Throwing <span style=color:#66d9ef>for</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span> <span style=color:#66d9ef>as</span> age cannot be negative
</span></span><span style=display:flex><span>Received cancel.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Sink Completion:  failure(__lldb_expr_201.CustomError.invalidArgument)
</span></span></code></pre></div><p>Notice how the subscription connection is established twice before the error is finally thrown in the <code>Sink</code> completion.</p><h3 id=approach-4><strong>Approach:</strong><a hidden class=anchor aria-hidden=true href=#approach-4>#</a></h3><h4 id=retry_-operator><code>retry(_:)</code> operator:<a hidden class=anchor aria-hidden=true href=#retry_-operator>#</a></h4><p>Use <code>retry(_:)</code> to try a connecting to an upstream publisher after a failed attempt.</p><ul><li><p>To achieve the desired output, we first need to extract the throwing block into a separate publisher variable.</p></li><li><p>We then apply the <code>retry</code> operator to this publisher. If the publisher emits a Failure, <code>retry</code> will reattempt the connection with the upstream publisher for the specified number of retries.</p></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>publisher.retry(<span style=color:#ae81ff>1</span>)
</span></span></code></pre></div><hr><h2 id=additional-key-concepts-in-error-handling><strong>Additional Key Concepts in Error Handling</strong><a hidden class=anchor aria-hidden=true href=#additional-key-concepts-in-error-handling>#</a></h2><h4 id=1-setfailuretypeto><code>1. setFailureType(to:)</code><a hidden class=anchor aria-hidden=true href=#1-setfailuretypeto>#</a></h4><p>Say, you are using Combine‚Äôs merge publishers such as - <a href=https://developer.apple.com/documentation/combine/publisher/merge(with:)-7fk3a>merge(with:)</a>, <a href=https://developer.apple.com/documentation/combine/publisher/zip(_:)>zip(_:)</a> etc. (We won‚Äôt dive deep into the implementation of these, maybe some other article)</p><p>The first publisher emits &lt;Int, Never> whereas the second publisher emits &lt;Int, CustomError>. Can you tell what‚Äôs wrong in the below code?</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#66d9ef>let</span> pub1 = [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>5</span>].publisher
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> pub2 = CurrentValueSubject&lt;Int, CustomError&gt;(<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> cancellable = pub1
</span></span><span style=display:flex><span>    .combineLatest(pub2)
</span></span><span style=display:flex><span>    .sink(
</span></span><span style=display:flex><span>        receiveCompletion: { print (<span style=color:#e6db74>&#34;completed: </span><span style=color:#e6db74>\(</span>$0<span style=color:#e6db74>)</span><span style=color:#e6db74>&#34;</span>) },
</span></span><span style=display:flex><span>        receiveValue: { print (<span style=color:#e6db74>&#34;value: </span><span style=color:#e6db74>\(</span>$0<span style=color:#e6db74>)</span><span style=color:#e6db74>&#34;</span>)}
</span></span><span style=display:flex><span>     )
</span></span></code></pre></div><p>When combining publishers, operators expect the publishers to emit the same failure type. If different error types are emitted, the code will fail. The compiler is smart enough to catch this error.</p><p><strong>But, why does this happen?</strong></p><p>Operators enforce this check to maintain type safety, ensuring a single type of error is emitted from a publisher. At any point in the chain, the type of <code>Output</code> and <code>Failure</code> should be determinable. Otherwise, an error will be thrown.</p><p><strong>How to solve this?</strong></p><p>Combine provides a built-in operator for such scenarios: <code>setFailureType(to:)</code>.</p><p><code>setFailureType(to:)</code> changes the failure type declared by the upstream publisher. This is used for setting the error type of a publisher that cannot fail.</p><p>In the above example, adding this operator after <code>pub1</code> will resolve the error.</p><pre tabindex=0><code>.setFailureType(to: CustomError.self) 
</code></pre><h4 id=2-try-operators>2. try* operators<a hidden class=anchor aria-hidden=true href=#2-try-operators>#</a></h4><p>You must be familiar with the try* variant of operators.</p><p>In our example for mapError above for Use case #2, you can notice that we had to optionally caste the error into our <code>CustomError</code> type. The compiler otherwise complained that it could not identify the type</p><p><strong>But, why did this happen?</strong></p><ul><li><p>These operators can emit either an <code>Output</code> or a <code>Failure</code></p></li><li><p>Swift doesn‚Äôt support typed throws yet. This means when you use <code>try</code>* operators, your error type will always be erased to the most common ancestor: <code>Error</code>.</p></li><li><p>Thereby need the optional type caste into our desired <code>Error</code> type.</p></li><li><p>As we‚Äôve already looked into above, <code>mapError</code> handles this use case perfectly.</p></li></ul><h4 id=3-assertnofailure-operator>3. <code>assertNoFailure</code> operator:<a hidden class=anchor aria-hidden=true href=#3-assertnofailure-operator>#</a></h4><ul><li><p>When you‚Äôre sure that the given programming path cannot throw an Error, you can use <strong>assertNoFailure(_:file:line:).</strong></p></li><li><p>It raises a fatal error when its upstream publisher fails, and otherwise republishes all received input.</p></li><li><p>As per Apple documentation: Use <code>assertNoFailure()</code> for internal integrity checks during testing. However, similar to <code>fatalError(_:)</code> in Swift, <code>assertNoFailure()</code> will trigger a fatal exception in both development and shipping versions of your code if a failure is encountered.</p></li><li><p>Strictly avoid this in production code as this is unsafe and makes assumptions. Use safer techniques discussed earlier.</p></li></ul><hr><p>And, that‚Äôs a wrap.</p><figure style="margin:1rem 0;text-align:center"><img src=https://nishanth-bs.github.io/post-images/combine-error-handling/8.gif alt style="display:block;margin:0 auto;max-width:100%;border-radius:8px"><figcaption style=font-size:.9rem;color:gray;margin-top:.5rem></figcaption></figure><p>These are the built-in error handling operators supported by Combine. You can mix and match these operators to suit your specific use cases.</p><p>In our next article, we will explore the nuances to keep in mind while creating a custom Publisher, including a custom publisher that will retry a given publisher up to a specific times and based on if whether the given condition is met. If you‚Äôre feeling adventurous, try this exercise and hit me up!</p><p>Stay tuned for more in-depth articles. Subscribe for free to receive new posts and support my work.</p><p>SubscribeIf you found this helpful, click the üíö and give it a clap below so others can discover it on Substack. For any questions or suggestions, feel free to leave a comment or reach out to me on <strong><a href=https://x.com/nishcr8>Twitter</a></strong> or <strong><a href=https://www.linkedin.com/in/nishanth-bs>LinkedIn</a></strong>.</p><p><a href=https://www.buymeacoffee.com/nishcr8>Enjoyed the Article? Buy Me a Coffee!</a></p><p>Let&rsquo;s push the boundaries of iOS development together!</p><hr><p>References:</p><ol><li><p><a href=https://stackoverflow.com/questions/58675235/combine-how-to-replace-catch-an-error-without-completing-the-original-publisher>https://stackoverflow.com/questions/58675235/combine-how-to-replace-catch-an-error-without-completing-the-original-publisher</a></p></li><li><p><a href=https://stackoverflow.com/questions/69371982/swift-combine-framework-setfailuretype-error-operator>https://stackoverflow.com/questions/69371982/swift-combine-framework-setfailuretype-error-operator</a></p></li><li><p><a href=https://developer.apple.com/documentation/combine>https://developer.apple.com/documentation/combine/empty/setfailuretype(to:)</a></p></li><li><p><a href=https://stackoverflow.com/questions/58227096/set-a-given-publishers-failure-type-to-never-in-combine>https://stackoverflow.com/questions/58227096/set-a-given-publishers-failure-type-to-never-in-combine</a></p></li><li><p><a href=https://stackoverflow.com/questions/58675235/combine-how-to-replace-catch-an-error-without-completing-the-original-publisher>https://stackoverflow.com/questions/58675235/combine-how-to-replace-catch-an-error-without-completing-the-original-publisher</a></p></li></ol></div><footer class=post-footer><ul class=post-tags><li><a href=https://nishanth-bs.github.io/tags/swift/>Swift</a></li><li><a href=https://nishanth-bs.github.io/tags/combine/>Combine</a></li></ul><nav class=paginav><a class=next href=https://nishanth-bs.github.io/mastering-swift-combine-5-essential-caveats-to-remember/><span class=title>Next ¬ª</span><br><span>Mastering Swift Combine: 5 Essential Caveats to Remember</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Everything about Error Handling in Combine on x" href="https://x.com/intent/tweet/?text=Everything%20about%20Error%20Handling%20in%20Combine&amp;url=https%3a%2f%2fnishanth-bs.github.io%2feverything-about-error-handling-in-combine%2f&amp;hashtags=Swift%2cCombine"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Everything about Error Handling in Combine on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fnishanth-bs.github.io%2feverything-about-error-handling-in-combine%2f&amp;title=Everything%20about%20Error%20Handling%20in%20Combine&amp;summary=Everything%20about%20Error%20Handling%20in%20Combine&amp;source=https%3a%2f%2fnishanth-bs.github.io%2feverything-about-error-handling-in-combine%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Everything about Error Handling in Combine on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fnishanth-bs.github.io%2feverything-about-error-handling-in-combine%2f&title=Everything%20about%20Error%20Handling%20in%20Combine"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Everything about Error Handling in Combine on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fnishanth-bs.github.io%2feverything-about-error-handling-in-combine%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Everything about Error Handling in Combine on whatsapp" href="https://api.whatsapp.com/send?text=Everything%20about%20Error%20Handling%20in%20Combine%20-%20https%3a%2f%2fnishanth-bs.github.io%2feverything-about-error-handling-in-combine%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Everything about Error Handling in Combine on telegram" href="https://telegram.me/share/url?text=Everything%20about%20Error%20Handling%20in%20Combine&amp;url=https%3a%2f%2fnishanth-bs.github.io%2feverything-about-error-handling-in-combine%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentColor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Everything about Error Handling in Combine on ycombinator" href="https://news.ycombinator.com/submitlink?t=Everything%20about%20Error%20Handling%20in%20Combine&u=https%3a%2f%2fnishanth-bs.github.io%2feverything-about-error-handling-in-combine%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><div id=progress-bar></div><div id=read-tooltip>üê£ Just started</div><canvas id=confetti-canvas style=position:fixed;top:0;left:0;pointer-events:none;z-index:99999></canvas><footer class=footer><span>&copy; 2025 <a href=https://nishanth-bs.github.io/>Decoded With Nishanth</a></span></footer><a href=#top id=top-link title="Back to top">‚¨ÜÔ∏è</a>
<link rel=stylesheet href=%20custom.css><style>#progress-bar{height:6px;background:linear-gradient(270deg,#006eff,#0072ff);background-size:400% 400%;width:0%;position:fixed;top:0;left:0;z-index:9999;transition:width .25s ease-out;box-shadow:0 0 8px rgba(0,114,255,.4)}@keyframes gradientFlow{0%{background-position:0}50%{background-position:100%}100%{background-position:0}}#read-tooltip{position:fixed;top:10px;right:12px;background:#1e88e5;color:#fff;padding:4px 10px;font-size:12px;border-radius:6px;z-index:9999;opacity:0;pointer-events:none;transition:opacity .5s ease,transform .3s;font-family:sans-serif}#read-tooltip.visible{opacity:.9}#read-tooltip.pulse{animation:pulse .5s ease}@keyframes pulse{0%{transform:scale(1)}50%{transform:scale(1.15)}100%{transform:scale(1)}}#top-link{position:fixed;bottom:24px;right:24px;display:none;font-size:24px;z-index:9999}</style><script src=https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js></script><script>const toggle=document.getElementById("theme-toggle"),getPreferredTheme=()=>{const e=localStorage.getItem("theme");if(e)return e;const t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;return t?"dark":"light"},applyTheme=e=>{document.body.classList.toggle("dark",e==="dark"),document.documentElement.setAttribute("data-theme",e)},currentTheme=getPreferredTheme();applyTheme(currentTheme),toggle&&toggle.addEventListener("click",()=>{const e=document.body.classList.contains("dark")?"light":"dark";localStorage.setItem("theme",e),applyTheme(e)}),function(){const e=localStorage.getItem("theme"),n=window.matchMedia("(prefers-color-scheme: dark)").matches;let t="light";e==="dark"||e==="light"?t=e:n&&(t="dark"),document.body.classList.add(t)}();const topBtn=document.getElementById("top-link");let lastScrollY=window.scrollY;const header=document.querySelector("header.header");window.addEventListener("scroll",()=>{topBtn.style.display=window.scrollY>400?"block":"none";const e=window.scrollY;if(e<=0){header.classList.remove("nav-hidden");return}e>lastScrollY&&e>50?header.classList.add("nav-hidden"):e<lastScrollY-10&&header.classList.remove("nav-hidden"),lastScrollY=e}),function(){const a=document.getElementById("progress-bar"),e=document.getElementById("read-tooltip"),i=document.getElementById("confetti-canvas"),f=document.querySelector("article.post-single")!==null;if(!f){a.style.display="none",e.style.display="none",i.style.display="none";return}let s=null,g=-1;const c=[0,25,50,75,100],n=new Set;let t=0;const l={0:["Just a scroll away from something cool.","This won't take long‚Äîpromise.","Your mind‚Äôs about to get a treat.","Let‚Äôs unlock a new insight today.","Brace yourself. Gold ahead.","This is the post you're looking for.","Scroll when you're ready. üòè","Quick value. Stay with it.","Skimming? You‚Äôll miss the best parts.","üëÄ Just look down...","Welcome! Let‚Äôs get into it.","Don‚Äôt just click away. Scroll a bit.","If you scroll, magic happens.","This ain‚Äôt fluff. Trust me.","Thought-provoking stuff ahead.","One scroll = one insight.","Your attention will pay off.","Hit that scroll. Unlock it.","Every expert starts here.","Go beyond headlines."],25:["Most readers stop here‚Äîdon't be 'most'.","You're past the intro‚Äîlet‚Äôs go deeper.","Keep going. Real gems start now.","Still with me? The good stuff‚Äôs just ahead.","You‚Äôre not a skimmer, right?","üî• Momentum's building‚Äîride it.","You made it further than 60% of visitors.","That curiosity? Feed it a little more.","Trust me, it gets more practical here.","üí° Insights are about to hit.","People bail here. But you‚Äôre smarter.","Let‚Äôs go past surface-level.","Depth is where value lives.","Scroll ‚â† commitment. But it‚Äôs close.","Hooked yet? Keep digging.","Still scrolling? You're crushing it.","Short attention spans? Not yours.","The meat of the post starts here.","Stay with me ‚Äî it gets juicy.","This part will surprise you."],50:["You‚Äôre halfway to brilliance.","This is the 'aha!' zone.","Power through. You‚Äôre absorbing now.","Still reading? You‚Äôre rare. üíé","More than theory ahead‚Äîexamples incoming.","Your future self thanks you.","üìà Retention rising. Keep scrolling.","Half-done ‚â† done. Stick with it.","This is where others quit. Not you.","üß† Brain activated. Let‚Äôs finish it.","Halfway heroes are the real MVPs.","Keep your eyes on the insight.","You‚Äôre deep in the content now.","Still locked in? Impressive.","Smart minds push past this.","Your focus is elite.","Ideas forming? Let‚Äôs build more.","üß© You‚Äôre piecing it together.","Big picture clarity up next.","You‚Äôre in the thinking zone."],75:["So close! Don‚Äôt lose steam.","This last part ties it all together.","Almost done. You‚Äôll want to see this.","Wrapping up soon‚Äîstick for the takeaway.","The summary‚Äôs near. You earned it.","üöÄ Let‚Äôs finish strong.","Few reach this far. You're one of them.","Still scrolling? You're elite. üî•","That last 25% ‚Üí clarity zone.","‚ú® Stick for the closer. It‚Äôs worth it.","Insights consolidate now. Pay attention.","You‚Äôve scrolled more than 90% of readers.","It‚Äôs crescendo time.","Pat yourself. You're nearly there.","Drop-off zone? Not today.","Final examples are üî•.","Don't skip the conclusion.","This is where ideas connect.","Clarity often comes right at the end.","Let‚Äôs seal the deal."],100:["üéâ You did it. Now own it.","Boom. Another post crushed.","üß† Knowledge absorbed!","Done. Reflect. Apply.","üî• You‚Äôre unstoppable.","That‚Äôs how pros read. üëè","Badge unlocked: Focused Reader","Send this to someone who skims. üòÖ","Crushed it. Now share it?","One read closer to mastery.","üèÜ Reader‚Äôs badge unlocked.","üéì Learned something? Pass it on.","You actually finished. Respect.","Legends read till the end.","Drop a comment now?","Still thinking about it? Good sign.","You‚Äôre 1% of readers who finish.","End? More like launchpad.","Thanks for sticking around!","üöÄ You just leveled up."]};function d(e){return c.slice().reverse().find(t=>e>=t)}function r(e){const t=l[e];return t[Math.floor(Math.random()*t.length)]}function u(e){const t=`scroll:${window.location.pathname}`;localStorage.setItem(t,e)}function h(){const e=`scroll:${window.location.pathname}`;return parseInt(localStorage.getItem(e))||0}function m(e){const t=document.documentElement.scrollHeight-window.innerHeight,n=Math.round(e/100*t);window.scrollTo(0,n)}function o(){const c=window.scrollY,l=document.documentElement.scrollHeight-window.innerHeight,i=Math.min(100,Math.round(c/l*100)),o=d(i);if(a.style.width=`${i}%`,u(i),o===100){p();return}if(!n.has(o)){n.add(o);let i=Date.now();if(i-t<2e3){console.log(Date.now()-t);return}console.log("now - lastPhraseTime");const a=r(o);e.innerText=a,e.classList.add("pulse","visible"),e.classList.add("visible"),s&&clearTimeout(s),s=setTimeout(()=>e.classList.remove("visible"),2e3),e.addEventListener("animationend",()=>{e.classList.remove("pulse")},{once:!0}),t=i}}let v=!1;function p(){if(window.hasFiredConfetti)return;window.hasFiredConfetti=!0,confetti({particleCount:1e3,angle:90,spread:120,startVelocity:60,gravity:.9,ticks:300,scalar:1.2,origin:{x:.5,y:1},colors:["#f94144","#f3722c","#f8961e","#f9c74f","#90be6d","#43aa8b","#577590","#277da1","#9d4edd","#e1306c"]})}function b(){const e=2*1e3,t=Date.now()+e,n={origin:{y:.6},startVelocity:30},s=window.confetti.create(i,{resize:!0}),o=setInterval(()=>{const e=t-Date.now();if(e<=0)return clearInterval(o);s({...n,particleCount:30,spread:100})},200)}window.addEventListener("load",()=>{const e=h();n.clear(),e>10&&e<90&&m(e),o()}),window.addEventListener("scroll",o)}()</script></body></html>